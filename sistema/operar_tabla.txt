delimiter $$

CREATE DEFINER=`root`@`localhost` PROCEDURE `operar_Tabla`(in tabla varchar(20),in parm varchar(20),in t_accion varchar(1),in att varchar(20), in cod int)
BEGIN
	case 
		when tabla = "almacen" then
			case
				when t_accion = "C" then
					case
						when att = "Codigo" then select * from almacen where idAlmacen = parm;
						when att = "Capacidad" then select * from almacen where capacidadMaxDeLotes = parm;
					end case;
				when t_accion = "M" then
					update almacen set capacidadMaxDeLotes=parm where idAlmacen = cod;
				when t_accion = "E" then
					update almacen set estado=parm where idAlmacen = cod;
			end case;
		when tabla = "factores" then
			case
				when t_accion = "C" then
					case
						when att = "Codigo" then select * from factores where idfactores = parm;
						when att = "Tabla" then select * from factores where tabla = parm;
						when att = "Concepto" then select * from factores where concepto = parm;
						when att = "Monto" then select * from factores where monto = parm;
					end case;
				when t_accion = "M" then
					case
						when att = "Tabla" then update factores set tabla = parm where idFactores = cod;
						when att = "Concepto" then update factores set concepto = parm where idFactores = cod;
						when att = "Monto" then update factores set monto = parm where idFactores = cod;
					end case;
				when t_accion = "E" then
						update factores set estado = parm where idFactores = cod;
			end case;
		when tabla = "mercaderia" then
			case
				when t_accion = "C" then
					case
						when att = "Codigo" then select * from mercaderia where idMercaderia = parm;
						when att = "Cod_Interno" then select * from mercaderia where codInternoMercaderia = parm;
						when att = "Nombre" then select * from mercaderia where nomMercaderia = parm;
						when att = "Descripcion" then select * from mercaderia where descripcionMercaderia = parm;
						when att = "Prooveedor" then select * from mercaderia where proveedorMercaderia = parm;
						when att = "Stock" then select * from mercaderia where stockDisponible = parm;
						when att = "PrecioVenta" then select * from mercaderia where precioXUnidadMedidad = parm;
						when att = "FechaAdquisicionProduccion" then select * from mercaderia where fechaAdqusicionProduccion = parm;						
						when att = "PrecioCompra" then select * from mercaderias where precioAdquisicion = parm;
						when att = "Lote" then select * from mercaderia where codigoLote = parm;
						when att = "Minimo" then select * from mercaderia where minXLote = parm;
						when att = "FechaVencimiento" then select * from mercaderia where fechaVencimiento = parm;
						
					end case;
			end case;
	end case;
END$$

